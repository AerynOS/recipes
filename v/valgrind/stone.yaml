#
# SPDX-FileCopyrightText: Â© 2020-2024 Serpent OS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : valgrind
version     : 3.25.1
release     : 9
homepage    : https://valgrind.org/
upstreams   :
    - https://sourceware.org/pub/valgrind/valgrind-3.25.1.tar.bz2 : 61deb8d0727b45c268efdc1b3b6c9e679cd97cbf5ee4b28d1dead7c8b7a271af
summary     : Instrumentation framework for testing & debugging
description : |
    Valgrind is an instrumentation framework for building dynamic analysis tools.
    There are Valgrind tools that can automatically detect many memory management
    and threading bugs, and profile your programs in detail.
license     :
    - GPL-2.0-or-later
tuning      :
    - harden: none
    - bindnow: false
    - lto: false
rundeps     :
    - glibc-dbginfo
setup       : |
    # Undo a Makefile.am hack related to making non GCC compatible compilers behave w/mpi
    %patch %(pkgdir)/mpi-respect-flags.patch
    %patch %(pkgdir)/rtlib.patch

    # We disable lto tuning above and instead enable Valgrind's own LTO -- otherwise we
    # get undefined symbol linker errors after running coregrind checks
    %reconfigure --enable-lto
build       : |
    %make
install     : |
    %make_install
