#
# SPDX-FileCopyrightText: Â© 2020-2024 Serpent OS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : cracklib
version     : 2.10.3
release     : 3
homepage    : https://github.com/cracklib/cracklib
upstreams   :
    - https://github.com/cracklib/cracklib/releases/download/v2.10.3/cracklib-2.10.3.tar.xz: 1d1b83676b5673051b9373e1ca0db81c1fa88faf9a195a3c1af984fd9c250d66
    - https://github.com/cracklib/cracklib/releases/download/v2.10.3/cracklib-words-2.10.3.xz:
        hash: b3d1e0e0ae9bc7ffed65c0042d7c68bdb903368aa6b918f94572453c6ea874dc
        unpack: false
        rename: cracklib-words.xz
summary     : CrackLib library and dictionaries
description : |
    CrackLib library and dictionaries
license     :
    - LGPL-2.1-or-later
builddeps   :
    - binary(file)
    - binary(gzip)
    - pkgconfig(zlib)
environment : |
    _dict_dir="%(datadir)/cracklib"
    _dict_path="${_dict_dir}/pw_dict"
setup       : |
    unxz -d %(sourcedir)/cracklib-words.xz -c > cracklib-words

    %configure \
        --disable-static \
        --with-default-dict="${_dict_path}" \
        --without-python
build       : |
    %make
install     : |
    %make_install

    ./util/cracklib-format cracklib-words | \
        ./util/cracklib-packer %(installroot)/${_dict_path}
    ./util/cracklib-format %(installroot)/${_dict_dir}/cracklib-small | \
        ./util/cracklib-packer %(installroot)/${_dict_dir}/cracklib-small
    rm -v %(installroot)/${_dict_dir}/cracklib-small
