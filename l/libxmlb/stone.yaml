#
# SPDX-FileCopyrightText: Â© 2020-2024 Serpent OS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : libxmlb
version     : "0.3.25"
release     : 9
homepage    : https://github.com/hughsie/libxmlb
upstreams   :
    - https://github.com/hughsie/libxmlb/releases/download/0.3.25/libxmlb-0.3.25.tar.xz : 77f2768c9debd2e946173cdf9465efd987849805e7c58251c5772ea728a61d9a
summary     : A library to help create and query binary XML blobs
description : |
    A library to help create and query binary XML blobs
license     :
    - LGPL-2.1-or-later
builddeps   :
    - binary(diff)
    - binary(python3)
    - pkgconfig(gio-2.0)
    - pkgconfig(gio-unix-2.0)
    - pkgconfig(gobject-introspection-1.0)
    - pkgconfig(liblzma)
    - pkgconfig(libzstd)
setup       : |
    %meson -Dgtkdoc=false
build       : |
    %meson_build
install     : |
    %meson_install

    # nuke installed tests
    rm -fr %(installroot)%(libdir)/libxmlb/installed-tests/
    rm -fr %(installroot)/usr/share/installed-tests
    rmdir %(installroot)%(libdir)/libxmlb
check       : |
    # The dependency ordering for this is slightly broken, and this needs to be built before tests can run
    meson compile src/libxmlb-mapfile -C %(builddir)

    %meson_test
