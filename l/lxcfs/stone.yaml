#
# SPDX-FileCopyrightText: Â© 2020-2025 Serpent OS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : lxcfs
version     : "6.0.6"
release     : 4
upstreams   :
    - https://linuxcontainers.org/downloads/lxcfs/lxcfs-6.0.6.tar.gz : 386339ba4cde289b0f6df4fe7a614caa1e45dd91bc0200b4aff6c51bf9d5ef9e
homepage    : https://www.hadrons.org/software/libmd
license     : BSD-3-Clause AND BSD-2-Clause
summary     : FUSE filesystem for LXC
description : |
    LXCFS is a small FUSE filesystem written with the intention of making Linux containers feel more like a virtual machine
builddeps   :
    - binary(help2man)
    - pkgconfig(fuse3)
    - pkgconfig(systemd)
    - python(jinja2)
setup       : |
    # glibc 2.43 build failure, remove in future version
    # https://github.com/lxc/lxcfs/issues/707
    export CFLAGS+=" -Wno-error=incompatible-pointer-types-discards-qualifiers"

    %meson
build       : |
    %meson_build
install     : |
    %meson_install
    %install_file %(pkgdir)/lxcfs.preset -t %(installroot)/%(libdir)/systemd/system-preset
    %install_file %(pkgdir)/lxcfs.tmpfiles %(installroot)%(tmpfilesdir)/lxcfs.conf
    %install_file %(pkgdir)/lxcfs.service %(installroot)%(libdir)/systemd/system/lxcfs.service
