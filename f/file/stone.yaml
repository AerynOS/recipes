#
# SPDX-FileCopyrightText: Â© 2020-2024 Serpent OS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : file
version     : "5.47"
release     : 11
homepage    : https://astron.com/pub/file
upstreams   :
    - https://astron.com/pub/file/file-5.47.tar.gz : 45672fec165cb4cc1358a2d76b5d57d22876dcb97ab169427ac385cbe1d5597a
summary     : File type identification utility
description : |
    File type identification utility
license     :
    - BSD-2-Clause
builddeps   :
    - binary(flex)
    - pkgconfig(bzip2)
    - pkgconfig(liblzma)
    - pkgconfig(libseccomp)
    - pkgconfig(libzstd)
    - pkgconfig(zlib)
setup       : |
    %patch %(pkgdir)/0001-magic-Support-Serpent-OS-stone-format.patch
    # Fix linking libmagic
    export CFLAGS="$CFLAGS -pthread"
    %reconfigure \
        --disable-static \
        --enable-shared \
        --enable-libseccomp
build      : |
    export LD_LIBRARY_PATH=$PWD/src/.libs
    %make
install     : |
    %make_install
    # Clean empty man dirs
    find %(installroot)%(mandir) -empty -type d -delete
# TODO: Pattern this, add python bindings
