#
# SPDX-FileCopyrightText: Â© 2020-2025 Serpent OS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : openal
version     : 1.25.1
release     : 5
upstreams   :
    - https://github.com/kcat/openal-soft/archive/refs/tags/1.25.1.tar.gz : 5f8efe8dfba5e9307a50251ba615ace857c7fa9dddfe34130b83e213d7f7cf24
homepage    : https://openal-soft.org/
license     : LGPL-2.1-or-later
summary     : Open Source OpenAL implementation
description : |
    OpenAL Soft is an LGPL-licensed, cross-platform, software implementation of the OpenAL 3D audio API. It's forked from the open-sourced Windows version available originally from openal.org's SVN repository (now defunct).
builddeps   :
    - pkgconfig(Qt6Widgets)
    - pkgconfig(alsa)
    - pkgconfig(dbus-1)
    - pkgconfig(fmt)
    - pkgconfig(libavcodec)
    - pkgconfig(libavdevice)
    - pkgconfig(libavformat)
    - pkgconfig(libavutil)
    - pkgconfig(libmysofa)
    - pkgconfig(libpipewire-0.3)
    - pkgconfig(libpulse)
    - pkgconfig(libswresample)
    - pkgconfig(libswscale)
    - pkgconfig(sdl3)
    - pkgconfig(sndfile)
    - pkgconfig(zlib)
    # JACK
setup       : |
    # TODO: Rebase this patch
    # patch %(pkgdir)/unbundle-fmt.patch

    %cmake
build       : |
    %cmake_build
install     : |
    %cmake_install

    # Not used?
    rm -v %(installroot)%(datadir)/openal/alsoftrc.sample \
          %(installroot)%(datadir)/openal/presets/presets.txt
packages    :
    - "%(name)":
        rundeps:
            # Uses dlopen(), but since pipewire is the default on Aeryn make sure it's available
            - "soname(libpipewire-0.3.so.0(x86_64))"

    - "%(name)-devel":
        paths:
            - /usr/bin/makemhr

    - "%(name)-examples":
        summary: Sample applications for OpenAl
        description: Sample applications for OpenAl
        paths:
            - /usr/bin/al*

    - "%(name)-qt":
        summary: Qt frontend for configuring OpenAL
        description: Qt frontend for configuring OpenAL
        rundeps:
            - qt6-wayland
        paths:
            - /usr/bin/alsoft-config
            - "%(name)"
