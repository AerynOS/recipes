#
# SPDX-FileCopyrightText: Â© 2020-2024 Serpent OS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : iptables
version     : "1.8.12"
release     : 7
homepage    : https://www.netfilter.org/projects/iptables/
upstreams   :
    - https://netfilter.org/pub/iptables/iptables-1.8.12.tar.xz : 8e7ee962601492de6503d171d4a948092ab18f89f111de72e3037c1f40cfb846
summary     : Linux kernel packet control tool (using nft interface)
description : |
    Linux kernel packet control tool (using nft interface)
license     :
    - GPL-2.0-only
builddeps   :
    - pkgconfig(libpcap)
    - pkgconfig(libmnl)
    - pkgconfig(libnftnl)
    - linux-headers
setup       : |
    %configure \
        --sysconfdir=%(vendordir)%(sysconfdir) \
        --disable-static \
        --enable-bpf-compiler \
        --enable-ipv6 \
        --enable-libipq \
        --enable-shared
build       : |
    %make
install     : |
    %make_install

    # Use NFT kernel interface
    for i in iptables iptables-restore iptables-save ip6tables ip6tables-restore ip6tables-save; do
        rm -v %(installroot)/%(sbindir)/$i
        ln -s xtables-nft-multi %(installroot)/%(sbindir)/$i
    done
tune        :
    - optimize: size
