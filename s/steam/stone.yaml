#
# SPDX-FileCopyrightText: Â© 2020-2024 Serpent OS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : steam
version     : 1.0.0.84
release     : 20
homepage    : https://store.steampowered.com/
upstreams   :
    - https://repo.steampowered.com/steam/pool/steam/s/steam/steam_1.0.0.84.tar.gz : 31fa762d58793f1aa8ea9df0122c3469c253fc8acb6daa7140fb7433fe077b44
summary     : Steam Client (WIP Packaging)
description : |
    steam is a digital distribution platform developed by Valve Corporation, which offers digital rights management (DRM), multiplayer gaming, video streaming and social networking services.
license     : Distributable
rundeps     :
    - binary(cmp)
    - binary(lsb_release)
    - binary(tar)
    - binary(xdg-user-dir)
    - binary(zenity)
    - soname(libGL.so.1(386))
    - soname(libGLX_mesa.so.0(386))
    - soname(libX11.so.6(386))
    - soname(libXext.so.6(386))
    - soname(libXxf86vm.so.1(386))
    - soname(libdb-5.1.so(386))
    - soname(libdrm.so.2(386))
    - soname(libelf.so.1(386))
    - soname(libgcc_s.so.1(386))
    - soname(libglib-2.0.so.0(386))
    - soname(libstdc++.so.6(386))
    - soname(libudev.so.1(386))
    - soname(libva.so.2(386))
    - soname(libvdpau.so.1(386))
    - soname(libvulkan.so.1(386))
    - soname(libz.so.1(386))
setup      : |
    %patch %(pkgdir)/rules.patch
    %patch %(pkgdir)/0001-work-around-steam-crash-with-DRI_PRIME.patch
install     : |
    %make_install

    # Replace steam with wrapper
    %install_exe %(pkgdir)/steam-wrapper.sh %(installroot)%(bindir)/steam

    %install_dir %(installroot)%(libdir)/udev/rules.d
    %install_file subprojects/steam-devices/* %(installroot)%(libdir)/udev/rules.d/.
    rm -v %(installroot)%(libdir)/udev/rules.d/LICENSE
