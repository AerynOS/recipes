#
# SPDX-FileCopyrightText: Â© 2020-2025 Serpent OS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : scx-scheds
version     : "1.0.19"
release     : 6
homepage    : https://github.com/sched-ext/scx
upstreams   :
    - https://github.com/sched-ext/scx/archive/refs/tags/v1.0.19.tar.gz : 1240edfdec50a915405571ba375b8b803201d23e6509e975bc101e633e8bdfeb
summary     : sched_ext schedulers
description : |
    sched_ext schedulers
networking  : yes
license     :
    - MIT
builddeps   :
    - binary(find)
    - binary(make)
    - pkgconfig(libbpf)
    - pkgconfig(libseccomp)
setup       : |
    %cargo_fetch
build       : |
    # Build rust schedulers
    %cargo_build
install     : |
    find "%(cargo_target_dir)" -maxdepth 1 -type f -executable -exec %install_exe {} -t %(installroot)%(bindir) \;

    # Useless stuff not needed
    rm -v %(installroot)%(bindir)/{scx_arena_selftests,vmlinux_docify,xtask}
packages    :
    - "%(name)-extra":
        summary: Various extra sched_ext schedulers
        description: |
            Various sched_ext schedulers that are either experimental, for testing purposes, are single-purpose in nature, or require significant additional configuration and know-how to be useful.
        paths:
            # If we ever re-add the C schedulers they should probably go in here
            - /usr/bin/scx_chaos
            - /usr/bin/scx_layered
            - /usr/bin/scx_mitosis
            - /usr/bin/scx_rlfifo
            - /usr/bin/scx_rustland
            - /usr/bin/scx_tickless
            - /usr/bin/scx_wd40
