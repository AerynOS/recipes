#
# SPDX-FileCopyrightText: Â© 2020-2024 Serpent OS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : mpv
version     : 0.40.0
release     : 9
homepage    : https://mpv.io/
upstreams   :
    - https://github.com/mpv-player/mpv/archive/refs/tags/v0.40.0.tar.gz : 10a0f4654f62140a6dd4d380dcf0bbdbdcf6e697556863dc499c296182f081a3
summary     : a free, open source, and cross-platform media player
description : |
  mpv is a free (as in freedom) media player for the command line. It supports a wide variety of media file formats, audio and video codecs, and subtitle types.
license     :
    - GPL-2.0-or-later
    - LGPL-2.1-or-later
builddeps   :
    - binary(python3)
    - binary(rst2man)
    - cmake(VulkanHeaders)
    - pkgconfig(alsa)
    # pkgconfig(caca)
    - pkgconfig(dvdnav)
    - pkgconfig(dvdread)
    - pkgconfig(egl)
    - pkgconfig(ffnvcodec)
    - pkgconfig(gbm)
    # pkgconfig(jack)
    - pkgconfig(lcms2)
    - pkgconfig(libarchive)
    - pkgconfig(libass)
    - pkgconfig(libavcodec)
    - pkgconfig(libavdevice)
    - pkgconfig(libavfilter)
    - pkgconfig(libavformat)
    - pkgconfig(libavutil)
    # pkgconfig(libbluray)
    # pkgconfig(libcdio)
    # pkgconfig(libcdio_paranoia)
    - pkgconfig(libdisplay-info)
    - pkgconfig(libdrm)
    - pkgconfig(libjpeg)
    - pkgconfig(libpipewire-0.3)
    - pkgconfig(libplacebo)
    - pkgconfig(libpulse)
    # pkgconfig(libsixel)
    - pkgconfig(libswresample)
    - pkgconfig(libswscale)
    - pkgconfig(libva)
    - pkgconfig(luajit)
    # pkgconfig(mujs)
    - pkgconfig(openal)
    # pkgconfig(rubberband)
    - pkgconfig(sdl2-compat)
    - pkgconfig(shaderc)
    - pkgconfig(sndio)
    # pkgconfig(spirv-cross-c-shared)
    # pkgconfig(uchardet)
    # pkgconfig(vapoursynth)
    - pkgconfig(vulkan)
    - pkgconfig(wayland-client)
    - pkgconfig(wayland-protocols)
    - pkgconfig(x11)
    - pkgconfig(xext)
    - pkgconfig(xkbcommon)
    # pkgconfig(xpresent)
    - pkgconfig(xrandr)
    - pkgconfig(xscrnsaver)
    - pkgconfig(xv)
    # pkgconfig(zimg)
    - pkgconfig(zlib)
setup       : |
    %patch %(pkgdir)/fix_wayland_clipboard_high_cpu_usage.patch

    %meson \
        -Dlibmpv=true \
        -Dopenal=enabled \
        -Dsdl2=enabled
build       : |
    %meson_build
install     : |
    %meson_install
packages:
    - "%(name)-libs":
        paths:
            - /usr/lib/*.so.*

    - "%(name)-libs-devel":
        paths:
            - /usr/include
            - /usr/lib/*.so
            - /usr/lib/pkgconfig
        rundeps:
            - mpv-libs
