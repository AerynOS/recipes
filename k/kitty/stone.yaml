#
# SPDX-FileCopyrightText: Â© 2025- AerynOS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : kitty
version     : 0.42.2
release     : 4
homepage    : https://github.com/kovidgoyal/kitty
upstreams   :
    - https://github.com/kovidgoyal/kitty/archive/refs/tags/v0.42.2.tar.gz : 6d16d4832e63f03ff2afca31681433f779ed148b4c6a8f09da3a09c97b0e0017
summary     : Cross-platform, fast, feature-rich, GPU based terminal
description : |
    kitty the fast, feature-rich, GPU based terminal emulator
license     :
    - GPL-3.0-or-later
networking  : true
builddeps   :
    - binary(go)
    - binary(sphinx-build)
    - binary(tic)
    - pkgconfig(dbus-1)
    - pkgconfig(gl)
    - pkgconfig(harfbuzz)
    - pkgconfig(lcms2)
    - pkgconfig(libcrypto)
    - pkgconfig(libxxhash)
    - pkgconfig(python3)
    - pkgconfig(simde)
    - pkgconfig(wayland-protocols)
    - pkgconfig(wayland-scanner)
    - pkgconfig(xcursor)
    - pkgconfig(xi)
    - pkgconfig(xinerama)
    - pkgconfig(xkbcommon)
    - pkgconfig(xkbcommon-x11)
    - pkgconfig(xrandr)
    - font-symbols-nerd
    - python(pip)
build       : |
    export CGO_CPPFLAGS="${CPPFLAGS}"
    export CGO_CFLAGS="${CFLAGS}"
    export CGO_CXXFLAGS="${CXXFLAGS}"
    export CGO_LDFLAGS="${LDFLAGS}"
    export GOFLAGS="-buildmode=pie -trimpath -ldflags=-linkmode=external -mod=readonly -modcacherw"

    python -m pip install -r docs/requirements.txt
    %make
    %make linux-package
install     : |
    linux-package/bin/kitten __complete__ setup bash | %install_file /dev/stdin %(installroot)%(datadir)/bash-completion/completions/kitty
    linux-package/bin/kitten __complete__ setup fish | %install_file /dev/stdin %(installroot)%(datadir)/fish/vendor_completions.d/kitty.fish
    linux-package/bin/kitten __complete__ setup zsh  | %install_file /dev/stdin %(installroot)%(datadir)/zsh/site-functions/_kitty

    %install_dir %(installroot)%(prefix)
    cp -r linux-package/* %(installroot)%(prefix)

