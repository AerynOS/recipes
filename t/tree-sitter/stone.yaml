#
# SPDX-FileCopyrightText: Â© 2025- AerynOS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : tree-sitter
version     : "0.26.5"
release     : 1
homepage    : https://tree-sitter.github.io/
upstreams   :
    - https://github.com/tree-sitter/tree-sitter/archive/refs/tags/v0.26.5.tar.gz : 8e012493b2103e0471d3aba8048b73bc1a3138132974e2fd8bfb89a63e62f478
summary     : An incremental parsing system for programming tools
description : |
    Tree-sitter is a parser generator tool and an incremental parsing library. It can build a concrete syntax tree for a source file and efficiently update the syntax tree as the source file is edited.
license     :
    - MIT
networking  : true
tuning      :
    - lto: false
setup       : |
    # Enable LTO here
    %cmake -DCMAKE_INTERPROCEDURAL_OPTIMIZATION=ON
    %cargo_fetch
build       : |
    %cmake_build
    %cargo_build
    for completion in bash elvish fish nushell zsh; do
        cargo run --frozen --release -- \
            complete --shell $completion > $completion-completions
    done
install     : |
    %cmake_install
    %cargo_install

    %install_dir %(installroot)%(bashcompletionsdir)
    %install_dir %(installroot)%(elvishcompletionsdir)
    %install_dir %(installroot)%(fishcompletionsdir)
    %install_dir %(installroot)%(zshcompletionsdir)
    %install_file bash-completions %(installroot)%(bashcompletionsdir)/%(name)
    %install_file elvish-completions %(installroot)%(elvishcompletionsdir)/%(name).elv
    %install_file fish-completions %(installroot)%(fishcompletionsdir)/%(name).fish
    %install_file zsh-completions %(installroot)%(zshcompletionsdir)/_%(name)
