#
# SPDX-FileCopyrightText: Â© 2020-2025 Serpent OS Developers
#
# SPDX-License-Identifier: MPL-2.0
#
name        : jujutsu
version     : 0.33.0
release     : 3
homepage    : https://jj-vcs.github.io/jj/ 
upstreams   :
    - https://github.com/jj-vcs/jj/archive/refs/tags/v0.33.0.tar.gz : 1b8f6bdbcf8e53d6d873c8677154fe8e3f491e67b07b408c0c7418cc37ab39ee
summary     : Git-compatible VCS that is both simple and powerful
description : |
    Git-compatible VCS that is both simple and powerful
networking  : yes
license     : Apache-2.0
builddeps   :
    - binary(cargo)
setup       : |
    %patch %(pkgdir)/0001-downstream-Default-to-nano-instead-of-pico.patch

    %cargo_fetch
build       : |
    %cargo_build --all-features
install     : |
    _jj=%(cargo_target_dir)/jj

    %install_bin ${_jj}

    ${_jj} util completion bash | %install_file /dev/stdin %(installroot)%(bashcompletionsdir)/jj
    ${_jj} util completion zsh | tail -n+3 | %install_file /dev/stdin %(installroot)%(zshcompletionsdir)/_jj
    # Don't install fish completions as the fish package ships a superior version

    %install_dir %(installroot)%(mandir)
    ${_jj} util install-man-pages %(installroot)%(mandir)
